# 1 环境变量
## 1.1 变量与环境变量
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;变量是计算机中用于记录一个值（不一定是数值，也可以是字符或字符串）的符号，而这些符号将用于不同的运算处理中。通常变量与值是一对一的关系，可以通过表达式读取它的值并赋值给其它变量，也可以直接指定数值赋值给任意变量。为了便于运算和处理，大部分的编程语言会区分变量的类型，用于分别记录数值、字符或者字符串等等数据类型。Shell 中的变量也基本如此，有不同类型（但不用专门指定类型名），可以参与运算，有作用域限定。

> 变量的作用域即变量的有效范围（比如一个函数中、一个源文件中或者全局范围），在该范围内只能有一个同名变量。一旦离开则该变量无效，如同不存在这个变量一般。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用 `declare` 命令创建一个变量名为 tmp 的变量：
```bash
declare tmp			# 这里可以不用 declare 预声明一个变量，直接即用即创建；但在创建其它指定类型的变量（如数组）时会用到
tmp=shiyanlou       # 与其他语言不同的是， Shell 中的赋值操作，= 两边不可以输入空格，否则会报错
echo $tmp      		# 读取变量的值，$符号用于表示引用一个变量的值
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**注意**：并不是任何形式的变量名都是可用的，变量名只能是英文字母、数字或者下划线，且不能以数字作为开头。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;环境变量的作用域比自定义变量的要大，如 Shell 的环境变量作用于自身和它的子进程。在所有的 UNIX 和类 UNIX 系统中，每个进程都有其各自的环境变量设置，且默认情况下，当一个进程被创建时，除了创建过程中明确指定的话，它将继承其父进程的绝大部分环境设置。Shell 程序也作为一个进程运行在操作系统之上，而我们在 Shell 中运行的大部分命令都将以 Shell 的子进程的方式运行。


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们通常会遇到的变量类型有三种：

* 当前 Shell 进程私有用户自定义变量，如上面我们创建的 tmp 变量，只在当前 Shell 中有效。
* Shell 本身内建的变量。
* 从自定义变量导出的环境变量。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;也有三个与上述三种环境变量相关的命令：`set`，`env`，`export`。这三个命令很相似，都是用于打印环境变量信息，区别在于涉及的变量范围不同。详见下表：

| 命令 | 说明 |
| --- | --- |
|`set` |显示当前 Shell 所有变量，包括其内建环境变量（与 Shell 外观等相关），用户自定义变量及导出的环境变量。 |
| `env` |显示与当前用户相关的环境变量，还可以让命令在指定环境中运行. |
| `export` |显示从 Shell 中导出成环境变量的变量，也能通过它将自定义变量导出为环境变量。 |
***

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;按变量的生存周期来划分，Linux 变量可分为两类：
* 永久的：需要修改配置文件，变量永久生效；
* 临时的：使用 `export` 命令行声明即可，变量在关闭 Shell 时失效。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**注意**：shell 变量一般存放在 `/etc/bashrc` 文件里，环境变量一般存放在 `/etc/profile` 文件里，写在 `/etc/profile` 里面的是对所有用户永久生效，如果想要添加一个永久生效的环境变量，只需要打开 `/etc/profile`，在最后加上你想添加的环境变量就可以了。


## 1.2 命令的查找路径与顺序
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`PATH` 里面就保存了 Shell 中执行的命令的搜索路径，在Windows 中的也是有这么一个 `PATH` 环境变量.
```bash
echo $PATH
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;要想像使用系统命令一样执行自己创建的脚本文件或者程序，就要将命令所在路径添加到 PATH 环境变量里。
## 1.3 添加自定义路径到“PATH”环境变量
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`PATH` 里面的路径是以 `:` 作为分割符的，所以我们可以这样添加自定义路径：
```bash
PATH=$PATH:/home/shiyanlou/mybin		#注意这里一定要使用绝对路径
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此时添加的环境变量只在当前shell有效，如果想要环境变量全局有效，就必须修改配置文件
```bash
cat /etc/shells     # 查看当前系统已安装的Shell
echo "PATH=$PATH:/home/shiyanlou/mybin" >> .zshrc
# 上述命令中 >> 表示将标准输出以追加的方式重定向到一个文件中，注意前面用到的 > 是以覆盖的方式重定向到一个文件中，
# 使用的时候一定要注意分辨。在指定文件不存在的情况下都会创建新的文件。
```
## 1.4 修改和删除已有变量
**1、变量修改**
```bash
${变量名#匹配字符串}  # 从头向后开始匹配，删除符合匹配字串的最短数据
```
**2、变量删除**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可以使用`unset` 命令删除一个环境变量
## 1.5 如何让环境变量立即生效
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在 Shell 中修改了一个配置脚本文件之后（比如 zsh 的配置文件 home 目录下的 .zshrc），每次都要退出终端重新打开甚至重启主机之后其才能生效，很是麻烦，我们可以使用 `source` 命令来让其立即生效，如：
```bash
source .zshrc   
# source 命令还有一个别名就是 .，上面的命令如果替换成 . 的方式就该是：
. ./.zshrc
```

***

# 2 搜索文件
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与搜索相关的命令常用的有 `whereis`，`which`，`find` 和 `locate`。

1、whereis 简单快速

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`whereis` 只能搜索二进制文件（-b），man 帮助文件（-m）和源代码文件（-s）。如果想要获得更全面的搜索结果可以使用 `locate` 命令。
```bash
whereis who
whereis find
```
2、locate 快而全

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用 `locate` 命令查找文件也不会遍历硬盘，它通过查询 `/var/lib/mlocate/mlocate.db` 数据库来检索信息。不过这个数据库也不是实时更新的，系统会使用定时任务每天自动执行 `updatedb` 命令来更新数据库。所以有时候你刚添加的文件，它可能会找不到，需要手动执行一次 `updatedb` 命令（在我们的环境中必须先执行一次该命令）。注意这个命令也不是内置的命令，在部分环境中需要手动安装，然后执行更新。
```bash
locate /etc/sh  	# 注意，它不只是在 /etc 目录下查找，还会自动递归子目录进行查找。
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;想只统计数目可以加上 -c 参数，-i 参数可以忽略大小写进行查找，`whereis` 的 -b、-m、-s 同样可以使用。
3、`which` 小而精

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`which` 本身是 `Shell` 内建的一个命令，我们通常使用 `which` 来确定是否安装了某个指定的程序，因为它只从 PATH 环境变量指定的路径中去搜索命令并且返回第一个搜索到的结果。也就是说，我们可以看到某个系统命令是否存在以及执行的到底是哪一个地方的命令。
```bash
which man 
which nginx
which ping
```
4、`find` 精而细

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`find` 应该是这几个命令中最强大的了，它不但可以通过文件类型、文件名进行查找而且可以根据文件的属性（如文件的时间戳，文件的权限等）进行搜索。`find` 命令强大到，要把它讲明白至少需要单独好几节课程才行，我们这里只介绍一些常用的内容。这条命令表示去` /etc/` 目录下面 ，搜索名字叫做 `interfaces` 的文件或者目录。这是 `find` 命令最常见的格式，千万记住 `find` 的第一个参数是要搜索的地方。命令前面加上 `sudo` 是因为 `shiyanlou` 只是普通用户，对 `/etc` 目录下的很多文件都没有访问的权限，如果是 `root` 用户则不用使用。
```bash
sudo find /etc/ -name interfaces
# find命令的路径是作为第一个参数的，基本命令格式为find  [path] [option][action]
```



