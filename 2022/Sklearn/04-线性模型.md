## 1 线性回归模型

### 1.1 普通最小二乘法
```python
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

X, y = mglearn.datasets.make_wave(n_samples=60)
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)

lr = LinearRegression().fit(X_train, y_train)
```


```python
print("lr.coef: {}".format(lr.coef_))               # lr.coef: [0.39390555]
print("lr.intercept_: {}".format(lr.intercept_))    # lr.intercept_: -0.031804343026759746
```


```python
print("Training set score: {:.2f}".format(lr.score(X_train, y_train)))      # Training set score: 0.67
print("Test set score: {:.2f}".format(lr.score(X_test, y_test)))        # Test set score: 0.66
```

```python
X, y = mglearn.datasets.load_extended_boston()

X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)
lr = LinearRegression().fit(X_train, y_train)
```

```python
print("Training set score: {:.2f}".format(lr.score(X_train, y_train)))  # Training set score: 0.95
print("Test set score: {:.2f}".format(lr.score(X_test, y_test)))    # Test set score: 0.61
```

### 1.2 岭回归

```python
from sklearn.linear_model import Ridge

ridge = Ridge().fit(X_train, y_train)
print("Training set score: {:.2f}".format(ridge.score(X_train, y_train)))       # Training set score: 0.89
print("Test set score: {:.2f}".format(ridge.score(X_test, y_test))) # Test set score: 0.75
```


```python
ridge10 = Ridge(alpha=10).fit(X_train, y_train)
print("Training set score: {:.2f}".format(ridge.score(X_train, y_train)))       # Training set score: 0.93
print("Test set score: {:.2f}".format(ridge.score(X_test, y_test)))     # Test set score: 0.77
```

```python
ridge01 = Ridge(alpha=0.1).fit(X_train, y_train)
print("Training set score: {:.2f}".format(ridge.score(X_train, y_train)))       # Training set score: 0.93
print("Test set score: {:.2f}".format(ridge.score(X_test, y_test)))     # Test set score: 0.77
```



```python
import matplotlib.pyplot as plt

plt.plot(ridge.coef_, 's', label="Ridge alpha=1")
plt.plot(ridge10.coef_, '^', label="Ridge alpha=10")
plt.plot(ridge01.coef_, 'v', label="Ridge alpha=0.1")

plt.plot(lr.coef_, 'o', label="LinearRegression")
plt.xlabel("Coefficient index")
plt.ylabel("Coefficient magnitude")
plt.hlines(0, 0, len(lr.coef_))     # 画水平线
plt.ylim(-25, 25)
plt.legend()
```
<img src ="https://img-blog.csdnimg.cn/f7e0b119afa74c27a2d0a7643d44c1bb.png#pic_center" width = 48%>


```python
mglearn.plots.plot_ridge_n_samples()
```
<img src ="https://img-blog.csdnimg.cn/5e4201b4e5c740c1b76e443f33163d93.png#pic_center" width = 48%>


```python
from sklearn.linear_model import Lasso
import numpy as np

lasso = Lasso().fit(X_train, y_train)
print("Training set score: {:.2f}".format(lasso.score(X_train, y_train)))
print("Test set score: {:.2f}".format(lasso.score(X_test, y_test)))
print("Number of features used: {}".format(np.sum(lasso.coef_ != 0)))
```


> Training set score: 0.29
> Test set score: 0.21
> Number of features used: 4



```python
lasso001 = Lasso(alpha=0.01, max_iter=100000).fit(X_train, y_train)
print("Training set score: {:.2f}".format(lasso001.score(X_train, y_train)))
print("Test set score: {:.2f}".format(lasso001.score(X_test, y_test)))
print("Number of features used: {}".format(np.sum(lasso001.coef_ != 0)))
```
> Training set score: 0.90
> Test set score: 0.77
> Number of features used: 33


```python
lasso00001 = Lasso(alpha=0.0001, max_iter=100000).fit(X_train, y_train)
print("Training set score: {:.2f}".format(lasso00001.score(X_train, y_train)))
print("Test set score: {:.2f}".format(lasso00001.score(X_test, y_test)))
print("Number of features used: {}".format(np.sum(lasso00001.coef_ != 0)))
```

> Training set score: 0.95
> Test set score: 0.64
> Number of features used: 96


```python
plt.plot(lasso.coef_, 's', label="Lasso alpha=1")
plt.plot(lasso001.coef_, 's', label="Lasso alpha=0.01")
plt.plot(lasso00001.coef_, 's', label="Lasso alpha=0.0001")

plt.plot(ridge01.coef_, "o", label="Ridge alpha=0.1")
plt.legend(ncol=2, loc=(0, 1.05))
plt.ylim(-25, 25)
plt.xlabel("Coefficient index")
plt.ylabel("Coefficient magnitude")
```

```python

```

```python

```














